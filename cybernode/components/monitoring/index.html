<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="cyber•Congress team">
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Monitoring - Cyber•Congress Docs</title>
        <link href="../../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../../css/highlight.css">
        <link href="../../../stylesheets/extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../..">Cyber•Congress Docs</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../../..">Home</a>
                    </li>
                    <li >
                        <a href="../../../contribute/">Contributing</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Staging <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../../staging/setup/">Mars Setup</a>
</li>
                            
<li >
    <a href="../../../staging/continuous-delivery/">Continuous Delivery</a>
</li>
                            
<li >
    <a href="../../../staging/run/">Running Application</a>
</li>
                            
<li >
    <a href="../../../staging/chains/">Local Sync Chains</a>
</li>
                            
<li >
    <a href="../../../staging/kubernetes/">Kubernetes</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cybernode <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../about/">About Node</a>
</li>
                            
<li >
    <a href="../../dev-setup/">Development Setup</a>
</li>
                            
<li >
    <a href="../../k8s-cheat-sheet/">K8s Cheat Sheet</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Components</a>
    <ul class="dropdown-menu">
            
<li class="active">
    <a href="./">Monitoring</a>
</li>
            
<li >
    <a href="../search/">Search</a>
</li>
            
<li >
    <a href="../markets/">Markets</a>
</li>
            
<li >
    <a href="../chain-nodes/">Chains Nodes</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Chains</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../chains/bitcoin/">Bitcoin</a>
</li>
            
<li >
    <a href="../../chains/ethereum/">Ethereum</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../../k8s-cheat-sheet/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../search/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/cybercongress/knowledge/edit/master/docs/cybernode/components/monitoring.md">Edit on cyberCongress/knowledge</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#monitoring-components">Monitoring Components</a></li>
            <li><a href="#prometheus">Prometheus</a></li>
            <li><a href="#grafana">Grafana</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="monitoring-components">Monitoring Components<a class="headerlink" href="#monitoring-components" title="Permanent link">&para;</a></h1>
<p>During lifetime cybernode collects various metrics using following components:</p>
<table>
<thead>
<tr>
<th>Component</th>
<th>Description</th>
<th>Cluster Address</th>
<th>External</th>
</tr>
</thead>
<tbody>
<tr>
<td>Prometheus Operator(PO)</td>
<td>Manages Prometheus Configuration</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Prometheus</td>
<td>Metrics Storage</td>
<td>prometheus.monitoring.svc:9090</td>
<td></td>
</tr>
<tr>
<td>Default Service Monitor</td>
<td>Default Service Monitor for PO</td>
<td></td>
<td></td>
</tr>
<tr>
<td>Grafana</td>
<td>Metrics Alerts and Web UI</td>
<td>grafana.monitoring.svc:3000</td>
<td>y</td>
</tr>
</tbody>
</table>
<h2 id="prometheus">Prometheus<a class="headerlink" href="#prometheus" title="Permanent link">&para;</a></h2>
<p><a href="https://prometheus.io/">Prometheus</a> is used as a main metrics storage. Components collect metrics and expose them via 
 HTTP endpoint, that Prometheus pulls at configured interval(our is 15s).</p>
<h3 id="prometheus-operator">Prometheus Operator<a class="headerlink" href="#prometheus-operator" title="Permanent link">&para;</a></h3>
<p>To deploy Prometheus atop Kubernetes, we use <a href="https://coreos.com/operators/prometheus/docs/latest/">Prometheus Operator</a>.
 It consists of Prometheus Operator itself, that introduced to cluster 
 <a href="https://kubernetes.io/docs/tasks/access-kubernetes-api/extend-api-custom-resource-definitions/">CRDs</a>: Prometheus,
 Service Monitor. PO automatically(dynamically) generate monitoring target configurations based on familiar Kubernetes label queries; 
 no need to learn a Prometheus specific configuration language.</p>
<h3 id="default-service-monitor">Default Service Monitor<a class="headerlink" href="#default-service-monitor" title="Permanent link">&para;</a></h3>
<p>To enable dynamic mapping for new pods to prometheus, service monitor(SM) is used. Each SM defines set of kubernetes 
 label filters.</p>
<h2 id="grafana">Grafana<a class="headerlink" href="#grafana" title="Permanent link">&para;</a></h2>
<p>To visualize metrics collected by Prometheus we use <a href="https://grafana.com/">Grafana</a>. In order to configure Grafana, three
 <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/">config maps</a> are used:</p>
<ol>
<li><strong>grafana-datasources</strong>. Define Prometheus datasource. </li>
<li><strong>grafana-dashboards</strong>. Gather predefined dashboards into single folder. </li>
<li><strong>grafana-dashboards-providers</strong>. Configuration for importing dashboards. </li>
</ol>
<h3 id="grafana-alerts">Grafana Alerts<a class="headerlink" href="#grafana-alerts" title="Permanent link">&para;</a></h3>
<p>Also Grafana supports checking metrics satisfied defined criteria. If criteria is violated, than notification is raised 
 to setup alert channels(in our case Telegram Group). To view list of available alerts check 
 "{grafana_host}/alerting/list" page. </p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2018 cyber • Congress</p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../../..';</script>
        <script src="../../../js/base.js"></script>
        <script src="../../../search/require.js"></script>
        <script src="../../../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
